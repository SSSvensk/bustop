<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
    <!--This is where accordion is built -->
	<div class="panel-group" id="accordion"></div>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCwZF98BYxJI7n2QcCd3q6-O3LwyAsg528"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/llb.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script>

	var directionsDisplay = new google.maps.DirectionsRenderer;

    //Function that binds each accordion into initialize_map-function
	function initinit(j, clat, clon, x, y) {
		$('#collapse'+j).on('hidden.bs.collapse', function (e) {
            initialize_map(j, clat, clon, x, y);
        });
        $('#collapse'+j).on('shown.bs.collapse', function (e) {
            initialize_map(j, clat, clon, x, y); 
        })
	}

    //Function that initializes the map to announced accordion tab with given attributes
	function initialize_map(j, clat, clon, x, y) {
        var nro = j;
        var myLatlng = new google.maps.LatLng(clat,clon);
        var mapOptions = {
            zoom: 17,
            scrollwheel: false,
            disableDefaultUI: true,
            center: myLatlng
        };

        var map = new google.maps.Map(document.getElementById('google-map'+nro), mapOptions);

        directionsDisplay.setMap(map);
            calculateAndDisplayRoute(clat, clon, directionsDisplay, nro, x, y, map);
        }

        //Function that calculates distance and duration and displays the route on map.
        function calculateAndDisplayRoute(clat, clon, directionsDisplay, nro, x, y, map) {
        	var directionsService = new google.maps.DirectionsService;
            directionsService.route({
                origin: new google.maps.LatLng(clat, clon),
                destination: new google.maps.LatLng(x, y),
                travelMode: 'WALKING'
            }, function(response, status) {
                if (status === 'OK') {
                    directionsDisplay.setDirections(response);
                    var infowindow2 = new google.maps.InfoWindow();
                    infowindow2.setContent(response.routes[0].legs[0].distance.text + "<br>" + response.routes[0].legs[0].duration.text + " ");
                    infowindow2.setPosition(response.routes[0].legs[0].end_location);
                    infowindow2.open(map);
                } else {
                    window.alert('Directions request failed due to ' + status);
                }
            });
        }
	</script>
</body>
</html>